(()=>{var o={n:t=>{var n=t&&t.__esModule?()=>t.default:()=>t;return o.d(n,{a:n}),n},d:(t,n)=>{for(var a in n)o.o(n,a)&&!o.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:n[a]})},o:(o,t)=>Object.prototype.hasOwnProperty.call(o,t)};(()=>{"use strict";const t=flarum.core.compat["forum/app"];var n=o.n(t);const a=flarum.core.compat["common/extend"],e=flarum.core.compat["forum/components/HeaderSecondary"];var r=o.n(e);const i=flarum.core.compat["common/components/LinkButton"];var l=o.n(i);function c(o,t){return c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,t){return o.__proto__=t,o},c(o,t)}const s=flarum.core.compat["common/components/Page"];var d=o.n(s);const u=flarum.core.compat["common/components/LoadingIndicator"];var f=o.n(u);const p=flarum.core.compat["common/components/Button"];var h=o.n(p),v=function(o){function t(){return o.apply(this,arguments)||this}var n,a;a=o,(n=t).prototype=Object.create(a.prototype),n.prototype.constructor=n,c(n,a);var e=t.prototype;return e.oninit=function(t){o.prototype.oninit.call(this,t),this.loading=!0,this.files=[],this.loadFiles()},e.loadFiles=function(){var o=this;app.request({method:"GET",url:app.forum.attribute("apiUrl")+"/fla-loader/user-files"}).then(function(t){o.files=t.data||[],o.loading=!1,m.redraw()}).catch(function(){o.loading=!1,m.redraw()})},e.view=function(){var o=this;return m("div",{className:"DownloadPage"},m("div",{className:"container"},m("h2",null,"Downloads"),this.loading?m(f(),null):0===this.files.length?m("p",null,"No files available for download."):m("div",{className:"FilesList"},this.files.map(function(t){return m("div",{key:t.id,className:"FileItem"},m("div",{className:"FileInfo"},m("h3",null,t.originalName),m("p",null,"Size: ",o.formatSize(t.size))),m(h(),{className:"Button Button--primary",onclick:function(){return o.downloadFile(t.id,t.originalName)}},"Download"))}))))},e.downloadFile=function(o,t){window.location.href=app.forum.attribute("apiUrl")+"/fla-loader/download/"+o},e.formatSize=function(o){if(0===o)return"0 Bytes";var t=Math.floor(Math.log(o)/Math.log(1024));return Math.round(o/Math.pow(1024,t)*100)/100+" "+["Bytes","KB","MB","GB"][t]},t}(d());n().initializers.add("undertaker/fla-loader",function(){(0,a.extend)(r().prototype,"items",function(o){n().session.user&&o.add("fla-loader-download",m(l(),{icon:"fas fa-download",href:n().route("flaLoaderDownload")},"Download"),10)}),n().routes.flaLoaderDownload={path:"/download",component:v}})})(),module.exports={}})();
//# sourceMappingURL=forum.js.map